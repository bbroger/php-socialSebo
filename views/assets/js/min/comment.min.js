function countCharacters(e,n,t){const o=t-e.value.length;document.getElementById(n).innerHTML=`${o} characters available`}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("baseUrl").value,n=document.forms.frmCommentBook,t=n.comment,o=document.getElementById("bookId"),a=n.btnComment,d=t.parentNode.querySelector("span.invalid-feedback"),i={bookId:null,comment:null};async function c(n){const t=await fetch(`${e}comment/getBookComments/${n}`,{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json"}});!function(e){const n=document.getElementById("bookComments");if(n.innerHTML="",e.length>0){const e=document.createElement("h3");e.classList.add("my-3"),e.innerHTML="Comments",n.appendChild(e)}for(const t of e){const e=document.createElement("div");e.classList.add("jumbotron","p-1","px-2");const o=document.createElement("p");o.classList.add("font-weight-bold","text-danger");const a=document.createElement("p");o.innerHTML=t.userName,a.innerHTML=t.comment,e.appendChild(o),e.appendChild(a),n.appendChild(e)}}(await t.json())}c(o.value),n.addEventListener("submit",n=>{n.preventDefault(),i.bookId=o.value,i.comment=t.value,function(e){return e.comment.length<10||e.comment.length>500||null===e.comment?(d.innerHTML="Please, type a comment between 10 and 500 characters!",t.classList.add("is-invalid"),!1):!(e.bookId<=0||null===e.bookId)||(d.innerHTML="The book id is invalid!",t.classList.add("is-invalid"),!1)}(i)&&async function(n){t.value="",a.disabled=!0,d.innerHTML="Registering your comment!";const i=await fetch(`${e}comment/insert`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),s=await i.json();void 0!==s.code&&1===s.code&&(t.classList.remove("is-invalid"),t.classList.add("is-valid"),d.innerHTML=s.message,c(o.value)),void 0!==s.code&&2===s.code&&(d.innerHTML=s.message),a.disabled=!1}(i)})});